<!DOCTYPE html>
<meta name="robots" content="noindex">
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ó–æ–æ–º–∞–≥–∞–∑–∏–Ω</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link rel="manifest" href="manifest.json">
  </head>
<body class="bg-gray-100 text-gray-900">
  <header class="bg-white shadow p-4 flex flex-col sm:flex-row sm:justify-between items-center">
    <div class="text-xl font-bold mb-2 sm:mb-0">üêæ –ó–æ–æ–º–∞–≥–∞–∑–∏–Ω</div>
    <nav class="flex gap-4">
      <a href="#about" class="text-blue-600 hover:underline">–û —Ñ–∏—Ä–º–µ</a>
      <a href="#catalog" class="text-blue-600 hover:underline">–ö–∞—Ç–∞–ª–æ–≥</a>
      <a href="#cart" class="text-blue-600 hover:underline">–ö–æ—Ä–∑–∏–Ω–∞</a>
      <a href="#offers" class="text-blue-600 hover:underline">–ê–∫—Ü–∏–∏</a>
      <a href="#contacts" class="text-blue-600 hover:underline">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
    </nav>
  </header>

  <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
  <div class="bg-blue-50 p-3 border-l-4 border-blue-400">
    <div class="flex justify-between items-center">
      <span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: <span id="userName" class="font-semibold">–ì–æ—Å—Ç—å</span></span>
      <span>–ë–∞–ª–ª—ã: <span id="bonusPoints" class="font-bold text-blue-600">0</span> üíé</span>
    </div>
  </div>

  <main class="p-4">
    <!-- –û –§–ò–†–ú–ï -->
    <section id="about" class="mb-6">
      <h2 class="text-lg font-semibold mb-2">–û –Ω–∞—à–µ–π —Ñ–∏—Ä–º–µ</h2>
      <div class="bg-white p-4 rounded shadow">
        <p>–ú—ã –∑–∞–±–æ—Ç–∏–º—Å—è –æ –¥–æ–º–∞—à–Ω–∏—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º —Ç–æ–ª—å–∫–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã. –ù–∞—à–∞ –±–æ–Ω—É—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±–∞–ª–ª—ã –∏ –ø–æ–º–æ–≥–∞—Ç—å –±–µ–∑–¥–æ–º–Ω—ã–º –∂–∏–≤–æ—Ç–Ω—ã–º!</p>
        <div class="mt-4 bg-gradient-to-r from-green-200 to-blue-200 h-48 flex items-center justify-center rounded">
          <div class="text-center">
            <div class="text-4xl mb-2">üè™üêïüêà</div>
            <div class="text-gray-700">–õ—É—á—à–∏–π –∑–æ–æ–º–∞–≥–∞–∑–∏–Ω –≤ –≥–æ—Ä–æ–¥–µ</div>
          </div>
        </div>
      </div>
    </section>

    <!-- –°–ò–°–¢–ï–ú–ê –ë–û–ù–£–°–û–í -->
    <section class="mb-6">
      <h2 class="text-lg font-semibold mb-2">–°–∏—Å—Ç–µ–º–∞ –±–æ–Ω—É—Å–æ–≤</h2>
      <div class="bg-white p-4 rounded shadow">
        <p class="text-sm text-gray-600 mb-3">üí° 1 üíé = 1 ‚ÇΩ. –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–ª–ª—ã –∫–∞–∫ –≤–∞–ª—é—Ç—É –¥–ª—è –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–π.</p>
        <div class="grid grid-cols-2 gap-2 text-xs">
          <div class="bg-gray-100 p-2 rounded">–î–æ 150‚ÇΩ ‚Üí 5 üíé</div>
          <div class="bg-gray-100 p-2 rounded">151-300‚ÇΩ ‚Üí 10 üíé</div>
          <div class="bg-gray-100 p-2 rounded">301-500‚ÇΩ ‚Üí 20 üíé</div>
          <div class="bg-gray-100 p-2 rounded">501-750‚ÇΩ ‚Üí 35 üíé</div>
          <div class="bg-gray-100 p-2 rounded">751-1000‚ÇΩ ‚Üí 50 üíé</div>
          <div class="bg-gray-100 p-2 rounded">1000‚ÇΩ+ ‚Üí 75 üíé</div>
        </div>
        <div class="mt-3 text-center">
          <button id="donateBtn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded transition-colors">
            üíó –ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å 50 –±–∞–ª–ª–æ–≤ –Ω–∞ –ø–æ–º–æ—â—å –∂–∏–≤–æ—Ç–Ω—ã–º
          </button>
        </div>
      </div>
    </section>

    <!-- –ö–ê–¢–ê–õ–û–ì -->
    <section id="catalog" class="mb-6">
      <h2 class="text-lg font-semibold mb-2">–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</h2>
      
      <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
      <div class="grid grid-cols-2 gap-4 mb-4">
        <button class="category-btn bg-white p-3 rounded shadow hover:bg-blue-50 transition-colors" data-category="dogs">
          üêï –°–æ–±–∞–∫–∏
        </button>
        <button class="category-btn bg-white p-3 rounded shadow hover:bg-blue-50 transition-colors" data-category="cats">
          üêà –ö–æ—à–∫–∏
        </button>
        <button class="category-btn bg-white p-3 rounded shadow hover:bg-blue-50 transition-colors" data-category="birds">
          ü¶ú –ü—Ç–∏—Ü—ã
        </button>
        <button class="category-btn bg-white p-3 rounded shadow hover:bg-blue-50 transition-colors" data-category="rodents">
          üêπ –ì—Ä—ã–∑—É–Ω—ã
        </button>
      </div>

      <!-- –§–∏–ª—å—Ç—Ä –ø–æ —Ç–æ–≤–∞—Ä–∞–º -->
      <div class="mb-4">
        <label for="productFilter" class="block text-sm font-medium text-gray-700 mb-1">–§–∏–ª—å—Ç—Ä –ø–æ —Ç–æ–≤–∞—Ä–∞–º:</label>
        <select id="productFilter" class="w-full p-2 border border-gray-300 rounded text-sm">
          <option value="">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</option>
        </select>
      </div>

      <!-- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ -->
      <div class="mb-4">
        <label for="sortSelect" class="block text-sm font-medium text-gray-700 mb-1">–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å:</label>
        <select id="sortSelect" class="w-full p-2 border border-gray-300 rounded text-sm">
          <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</option>
          <option value="price_asc">–ü–æ —Ü–µ–Ω–µ: –æ—Ç –Ω–∏–∑–∫–æ–π –∫ –≤—ã—Å–æ–∫–æ–π</option>
          <option value="price_desc">–ü–æ —Ü–µ–Ω–µ: –æ—Ç –≤—ã—Å–æ–∫–æ–π –∫ –Ω–∏–∑–∫–æ–π</option>
          <option value="name_asc">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é: –ê‚Äì–Ø</option>
          <option value="name_desc">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é: –Ø‚Äì–ê</option>
          <option value="bonus_asc">–ü–æ –±–æ–Ω—É—Å–∞–º: –æ—Ç –º–µ–Ω—å—à–∏—Ö –∫ –±–æ–ª—å—à–∏–º</option>
          <option value="bonus_desc">–ü–æ –±–æ–Ω—É—Å–∞–º: –æ—Ç –±–æ–ª—å—à–∏—Ö –∫ –º–µ–Ω—å—à–∏–º</option>
        </select>
      </div>

      <!-- –¢–æ–≤–∞—Ä—ã -->
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4" id="productList">
        <!-- JS –¥–æ–±–∞–≤–∏—Ç —Ç–æ–≤–∞—Ä—ã -->
      </div>
    </section>

    <!-- –ö–û–†–ó–ò–ù–ê -->
    <section id="cart" class="mb-6">
      <h2 class="text-lg font-semibold mb-2">–ö–æ—Ä–∑–∏–Ω–∞</h2>
      <div class="bg-white p-4 rounded shadow">
        <ul id="cartList" class="space-y-2"></ul>
        <div class="mt-4 text-right">
          <strong>–û–±—â–∏–µ –±–æ–Ω—É—Å—ã –∑–∞ –∑–∞–∫–∞–∑:</strong> 
          <span id="totalBonus" class="font-bold text-blue-600">0</span> üíé
        </div>
        <!-- –í–∞—Ä–∏–∞–Ω—Ç –æ–ø–ª–∞—Ç—ã -->
        <div class="mt-4">
          <label for="paymentMethod" class="block text-sm font-medium text-gray-700 mb-1">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:</label>
          <select id="paymentMethod" class="w-full p-2 border border-gray-300 rounded text-sm">
            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–±</option>
            <option value="card">–ë–∞–Ω–∫–æ–≤—Å–∫–æ–π –∫–∞—Ä—Ç–æ–π</option>
            <option value="sbp">–ß–µ—Ä–µ–∑ –°–ë–ü</option>
            <option value="cash">–ù–∞–ª–∏—á–Ω—ã–º–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</option>
          </select>
        </div>
        <!-- –í–∞—Ä–∏–∞–Ω—Ç –¥–æ—Å—Ç–∞–≤–∫–∏ -->
        <div class="mt-4">
          <label for="deliveryMethod" class="block text-sm font-medium text-gray-700 mb-1">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏:</label>
          <select id="deliveryMethod" class="w-full p-2 border border-gray-300 rounded text-sm">
            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–±</option>
            <option value="pickup">–°–∞–º–æ–≤—ã–≤–æ–∑ (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)</option>
            <option value="courier">–ö—É—Ä—å–µ—Ä—Å–∫–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ (300 ‚ÇΩ)</option>
            <option value="mail">–ü–æ—á—Ç–∞ –†–æ—Å—Å–∏–∏ (500 ‚ÇΩ)</option>
          </select>
        </div>
        <button id="checkoutBtn" class="mt-3 w-full bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded transition-colors">
          üì¶ –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
        </button>
      </div>
    </section>

    <!-- –ê–ö–¶–ò–ò -->
    <section id="offers" class="mb-6">
      <h2 class="text-lg font-semibold mb-2">–ù–∞—à–∏ –∞–∫—Ü–∏–∏</h2>
      <div class="bg-white p-4 rounded shadow">
        <ul class="list-disc list-inside space-y-1">
          <li>–°–∫–∏–¥–∫–∞ 10% –Ω–∞ –ø–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑</li>
          <li>–ö–∞–∂–¥–∞—è 5-—è –ø–æ–∫—É–ø–∫–∞ ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –±–æ–Ω—É—Å—ã!</li>
          <li>–ó–∞ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ–ª—É—á–∏—Ç–µ –æ—Å–æ–±—ã–π —Å—Ç–∞—Ç—É—Å üåü</li>
        </ul>
        <div class="mt-4 bg-gradient-to-r from-yellow-200 to-orange-200 h-48 flex items-center justify-center rounded">
          <div class="text-center">
            <div class="text-4xl mb-2">üéâ</div>
            <div class="text-gray-700 font-semibold">–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</div>
          </div>
        </div>
      </div>
    </section>

    <!-- –ö–û–ù–¢–ê–ö–¢–´ -->
    <section id="contacts">
      <h2 class="text-lg font-semibold mb-2">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
      <div class="bg-white p-4 rounded shadow">
        <div class="space-y-2">
          <p>üìß Email: info@zooshop.ru</p>
          <p>üìû –¢–µ–ª–µ—Ñ–æ–Ω: +7 (900) 123-45-67</p>
          <p>üìç –ê–¥—Ä–µ—Å: –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—É—à–∫–∏–Ω—Å–∫–∞—è, –¥. 10</p>
        </div>
        <div class="mt-4 bg-gradient-to-r from-green-200 to-teal-200 h-48 flex items-center justify-center rounded">
          <div class="text-center">
            <div class="text-4xl mb-2">üó∫Ô∏è</div>
            <div class="text-gray-700">–ù–∞—à –º–∞–≥–∞–∑–∏–Ω –Ω–∞ –∫–∞—Ä—Ç–µ</div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
    let tg = window.Telegram?.WebApp;
    let userId = null;
    let userName = '–ì–æ—Å—Ç—å';

    if (tg) {
      tg.ready();
      tg.expand();
      
      // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
      if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
        userId = tg.initDataUnsafe.user.id;
        userName = tg.initDataUnsafe.user.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
      }
    }

    // –ï—Å–ª–∏ Telegram –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Å–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π ID
    if (!userId) {
      userId = 'demo_' + Math.random().toString(36).substr(2, 9);
    }

    document.getElementById('userName').textContent = userName;

    // –¢–æ–≤–∞—Ä—ã —Å —Ä–∞–∑–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –±–æ–Ω—É—Å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
    const products = [
      { name: '–õ–∞–∫–æ–º—Å—Ç–≤–æ –¥–ª—è –∫–æ—à–µ–∫', price: 120, category: 'cats', emoji: 'üê±' },
      { name: '–ò–≥—Ä—É—à–∫–∞ –º—ã—à–∫–∞', price: 200, category: 'cats', emoji: 'üê≠' },
      { name: '–ö–æ—Ä–º –¥–ª—è —Å–æ–±–∞–∫ (1–∫–≥)', price: 450, category: 'dogs', emoji: 'üêï' },
      { name: '–ü–æ–≤–æ–¥–æ–∫ –∫–æ–∂–∞–Ω—ã–π', price: 680, category: 'dogs', emoji: 'ü¶Æ' },
      { name: '–ö–ª–µ—Ç–∫–∞ –¥–ª—è —Ö–æ–º—è–∫–∞', price: 890, category: 'rodents', emoji: 'üêπ' },
      { name: '–ö–æ—Ä–º –ø—Ä–µ–º–∏—É–º (5–∫–≥)', price: 1200, category: 'dogs', emoji: 'ü•ò' },
      { name: '–ó–µ—Ä–Ω–æ –¥–ª—è –ø–æ–ø—É–≥–∞–µ–≤', price: 380, category: 'birds', emoji: 'ü¶ú' },
      { name: '–í–∏—Ç–∞–º–∏–Ω—ã –¥–ª—è –ø—Ç–∏—Ü', price: 280, category: 'birds', emoji: 'üíä' },
    ];

    // –ö–∞—Ä—Ç–∞ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
    const productFilters = {
      dogs: [
        { name: '–ö–æ—Ä–º –¥–ª—è —Å–æ–±–∞–∫ (1–∫–≥)', emoji: 'üêï' },
        { name: '–ü–æ–≤–æ–¥–æ–∫ –∫–æ–∂–∞–Ω—ã–π', emoji: 'ü¶Æ' },
        { name: '–ö–æ—Ä–º –ø—Ä–µ–º–∏—É–º (5–∫–≥)', emoji: 'ü•ò' }
      ],
      cats: [
        { name: '–õ–∞–∫–æ–º—Å—Ç–≤–æ –¥–ª—è –∫–æ—à–µ–∫', emoji: 'üê±' },
        { name: '–ò–≥—Ä—É—à–∫–∞ –º—ã—à–∫–∞', emoji: 'üê≠' }
      ],
      birds: [
        { name: '–ó–µ—Ä–Ω–æ –¥–ª—è –ø–æ–ø—É–≥–∞–µ–≤', emoji: 'ü¶ú' },
        { name: '–í–∏—Ç–∞–º–∏–Ω—ã –¥–ª—è –ø—Ç–∏—Ü', emoji: 'üíä' }
      ],
      rodents: [
        { name: '–ö–ª–µ—Ç–∫–∞ –¥–ª—è —Ö–æ–º—è–∫–∞', emoji: 'üêπ' }
      ]
    };

    let currentCategory = 'all';
    let bonusPoints = 0;
    let purchaseCount = 0;
    let cart = [];// –ö–æ—Ä–∑–∏–Ω–∞

    // –§—É–Ω–∫—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ –±–æ–Ω—É—Å–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ü–µ–Ω—ã
    function calculateBonuses(price) {
      if (price <= 150) return 5;
      if (price <= 300) return 10;
      if (price <= 500) return 20;
      if (price <= 750) return 35;
      if (price <= 1000) return 50;
      return 75;
    }

    // –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–∏–≤—è–∑–∫–æ–π –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    function saveUserData() {
      const userData = {
        bonusPoints: bonusPoints,
        purchaseCount: purchaseCount,
        lastUpdate: Date.now()
      };
      
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º userId –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª—é—á–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π
      const userKey = `zooShop_user_${userId}`;
      const dataStr = JSON.stringify(userData);
      
      // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
      const checksum = btoa(dataStr).slice(-8);
      const secureData = {
        data: userData,
        checksum: checksum,
        userId: userId
      };
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ø–∞–º—è—Ç—å (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —ç—Ç–æ –±—ã–ª –±—ã —Å–µ—Ä–≤–µ—Ä)
      window.userDataStorage = window.userDataStorage || {};
      window.userDataStorage[userKey] = secureData;
    }

    // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    function loadUserData() {
      const userKey = `zooShop_user_${userId}`;
      
      // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏–∑ –ø–∞–º—è—Ç–∏ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —ç—Ç–æ –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–µ—Ä—É)
      window.userDataStorage = window.userDataStorage || {};
      const secureData = window.userDataStorage[userKey];
      
      if (secureData && secureData.userId === userId) {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
        const dataStr = JSON.stringify(secureData.data);
        const expectedChecksum = btoa(dataStr).slice(-8);
        
        if (secureData.checksum === expectedChecksum) {
          bonusPoints = secureData.data.bonusPoints || 0;
          purchaseCount = secureData.data.purchaseCount || 0;
        }
      }
      
      updateBonusDisplay();
    }

    function updateBonusDisplay() {
      document.getElementById('bonusPoints').textContent = bonusPoints;
    }

    // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
    function displayProducts(category = 'all') {
      const productList = document.getElementById('productList');
      const productFilter = document.getElementById('productFilter');
      const selectedProductName = productFilter.value;

      productList.innerHTML = '';

      let filteredProducts = category === 'all'
        ? products
        : products.filter(p => p.category === category);

      // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–æ–≤–∞—Ä ‚Äî —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø–æ –Ω–µ–º—É
      if (selectedProductName) {
        filteredProducts = filteredProducts.filter(p => p.name === selectedProductName);
      }

      // –í—ã–≤–æ–¥ —Ç–æ–≤–∞—Ä–æ–≤
      filteredProducts.forEach((product, i) => {
        const bonusAmount = calculateBonuses(product.price);
        const card = document.createElement('div');
        card.className = 'bg-white p-4 rounded shadow hover:shadow-md transition-shadow';
        card.innerHTML = `
          <div class="flex justify-between items-start mb-2">
            <h3 class="font-bold text-sm">${product.name}</h3>
            <span class="text-2xl">${product.emoji}</span>
          </div>
          <div class="text-lg font-semibold text-green-600 mb-1">${product.price} ‚ÇΩ</div>
          <div class="text-xs text-blue-600 mb-3">+${bonusAmount} –±–æ–Ω—É—Å–æ–≤ üíé</div>
          <div class="bg-gray-100 h-20 mb-3 rounded flex items-center justify-center text-gray-500 text-xs">
            –§–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞
          </div>
          <button class="w-full bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded transition-colors text-sm font-medium" 
                  onclick="addToCart(${products.indexOf(product)})">
            üõí –ö—É–ø–∏—Ç—å
          </button>
        `;
        productList.appendChild(card);
      });
    }

    // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
    function sortProducts(productsToSort, sortBy) {
      let sorted = [...productsToSort];

      switch (sortBy) {
        case 'price_asc':
          return sorted.sort((a, b) => a.price - b.price);
        case 'price_desc':
          return sorted.sort((a, b) => b.price - a.price);
        case 'name_asc':
          return sorted.sort((a, b) => a.name.localeCompare(b.name));
        case 'name_desc':
          return sorted.sort((a, b) => b.name.localeCompare(a.name));
        case 'bonus_asc':
          return sorted.sort((a, b) => calculateBonuses(a.price) - calculateBonuses(b.price));
        case 'bonus_desc':
          return sorted.sort((a, b) => calculateBonuses(b.price) - calculateBonuses(a.price));
        default:
          return sorted;
      }
    }

    // –ü–æ–∫—É–ø–∫–∞ —Ç–æ–≤–∞—Ä–∞
    function addToCart(index) {
      const product = products[index];
      const bonusAmount = calculateBonuses(product.price);
      
      bonusPoints += bonusAmount;
      purchaseCount++;
      
      // –ë–æ–Ω—É—Å –∑–∞ –∫–∞–∂–¥—É—é 5-—é –ø–æ–∫—É–ø–∫—É
      if (purchaseCount % 5 === 0) {
        bonusPoints += 25;
        showNotification(`üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –ó–∞ 5-—é –ø–æ–∫—É–ø–∫—É –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ 25 –±–æ–Ω—É—Å–æ–≤!`);
      }
      
      saveUserData();
      updateBonusDisplay();
      
      showNotification(`‚úÖ ${product.name} –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ—Ä–∑–∏–Ω—É!\n+${bonusAmount} –±–æ–Ω—É—Å–æ–≤ üíé`);
    }

    // –ü–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤
    function donateBonuses() {
      if (bonusPoints >= 50) {
        bonusPoints -= 50;
        saveUserData();
        updateBonusDisplay();
        showNotification('üíó –°–ø–∞—Å–∏–±–æ! –í–∞—à–∏ 50 –±–æ–Ω—É—Å–æ–≤ –ø–æ—à–ª–∏ –Ω–∞ –ø–æ–º–æ—â—å –±–µ–∑–¥–æ–º–Ω—ã–º –∂–∏–≤–æ—Ç–Ω—ã–º! üêæ\n–í—ã –ø–æ–ª—É—á–∏–ª–∏ –æ—Å–æ–±—ã–π —Å—Ç–∞—Ç—É—Å –ø–æ–º–æ—â–Ω–∏–∫–∞! üåü');
      } else {
        showNotification(`‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–∞–ª–ª–æ–≤. –ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 50, —É –≤–∞—Å: ${bonusPoints}`);
      }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    function updateCart() {
      const cartList = document.getElementById('cartList');
      const totalBonusEl = document.getElementById('totalBonus');
      cartList.innerHTML = '';
      let totalBonus = 0;

      if (cart.length === 0) {
        cartList.innerHTML = '<li class="text-gray-500 text-sm">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</li>';
      } else {
        cart.forEach(item => {
          const bonusAmount = calculateBonuses(item.price);
          totalBonus += bonusAmount;
          const li = document.createElement('li');
          li.className = 'flex justify-between items-center bg-gray-100 p-2 rounded';
          li.innerHTML = `
            <span>${item.emoji} ${item.name}</span>
            <span class="text-green-600">${item.price} ‚ÇΩ (+${bonusAmount} üíé)</span>
          `;
          cartList.appendChild(li);
        });
      }

      totalBonusEl.textContent = totalBonus;
    }

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –∫–æ—Ä–∑–∏–Ω—É
    function addToCart(index) {
      const product = products[index];
      cart.push(product);
      updateCart();
      showNotification(`‚úÖ ${product.name} –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ—Ä–∑–∏–Ω—É!`);
    }

    // –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
    function checkoutOrder() {
      if (cart.length === 0) {
        showNotification("‚ùå –ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞!");
        return;
      }

      const paymentSelect = document.getElementById('paymentMethod');
      const deliverySelect = document.getElementById('deliveryMethod');
      const selectedPayment = paymentSelect.value;
      const selectedDelivery = deliverySelect.value;

      if (!selectedPayment) {
        showNotification("‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã");
        return;
      }
      
      if (!selectedDelivery) {
      showNotification("‚ö†Ô∏è –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏");
      return;
      }

      let totalBonus = 0;
      let totalPrice = 0;
      
      cart.forEach(product => {
        const bonusAmount = calculateBonuses(product.price);
        totalBonus += bonusAmount;
        totalPrice += product.price;
      });

      // –°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏
      let deliveryCost = 0;
      let deliveryText = '';
      switch (selectedDelivery) {
        case 'pickup':
          deliveryCost = 0;
          deliveryText = 'üì¶ –°–∞–º–æ–≤—ã–≤–æ–∑ (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)';
          break;
        case 'courier':
          deliveryCost = 300;
          deliveryText = 'üöö –ö—É—Ä—å–µ—Ä—Å–∫–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ (300 ‚ÇΩ)';
          break;
        case 'mail':
          deliveryCost = 500;
          deliveryText = 'üì¨ –ü–æ—á—Ç–∞ –†–æ—Å—Å–∏–∏ (500 ‚ÇΩ)';
          break;
      }

      totalPrice += deliveryCost;

      // –ù–∞—á–∏—Å–ª—è–µ–º –æ–±—â–∏–µ –±–æ–Ω—É—Å—ã
      bonusPoints += totalBonus;
      purchaseCount += 1;

      // –ë–æ–Ω—É—Å –∑–∞ –∫–∞–∂–¥—É—é 5-—é –ø–æ–∫—É–ø–∫—É
      if (purchaseCount % 5 === 0) {
        bonusPoints += 25;
        showNotification(`üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –ó–∞ 5-—é –ø–æ–∫—É–ø–∫—É –≤—ã –ø–æ–ª—É—á–∏–ª–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ 25 –±–æ–Ω—É—Å–æ–≤!`);
      }

      saveUserData();
      updateBonusDisplay();

      // –û—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
      cart = [];
      updateCart();

      

      // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –∏—Ç–æ–≥–æ–≤–æ–π —Å—É–º–º–æ–π
      showNotification(`üì¶ –ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω!\n\n${deliveryText}\n\n–°—É–º–º–∞ –∑–∞–∫–∞–∑–∞: ${totalPrice} ‚ÇΩ\n–í—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∏ ${totalBonus} –±–æ–Ω—É—Å–æ–≤ üíé –∑–∞ —ç—Ç–æ—Ç –∑–∞–∫–∞–∑!\n–¢–µ–ø–µ—Ä—å —É –≤–∞—Å: ${bonusPoints} üíé`);
    }

    // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    function showNotification(message) {
      if (tg && tg.showAlert) {
        tg.showAlert(message);
      } else {
        alert(message);
      }
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    document.getElementById('donateBtn').addEventListener('click', donateBonuses);

    // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º + –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ —Ç–æ–≤–∞—Ä–∞–º
    document.querySelectorAll('.category-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        const category = e.target.dataset.category;

        // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
        document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('bg-blue-100'));
        e.target.classList.add('bg-blue-100');

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–æ–≤–∞—Ä–∞–º
        const productFilter = document.getElementById('productFilter');
        productFilter.innerHTML = '<option value="">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</option>';

        if (productFilters[category]) {
          productFilters[category].forEach(item => {
            const option = document.createElement('option');
            option.value = item.name;
            option.textContent = `${item.emoji} ${item.name}`;
            productFilter.appendChild(option);
          });
        }

        displayProducts(category);
      });
    });

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞–Ω–∏–∏
    function showDonationInfo() {
      const message = '–í—ã –∂–µ—Ä—Ç–≤—É–µ—Ç–µ 50 —Ä—É–±–ª–µ–π. –≠—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –ø–æ–π–¥—É—Ç –Ω–∞ –ø–æ–º–æ—â—å –±–µ–∑–¥–æ–º–Ω—ã–º –∂–∏–≤–æ—Ç–Ω—ã–º. –°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à—É –¥–æ–±—Ä–æ—Ç—É!';
      if (tg && tg.showAlert) {
        tg.showAlert(message);
      } else {
        alert(message);
      }
    }

    // –ü—Ä–∏–≤—è–∑–∫–∞ –∫–Ω–æ–ø–∫–∏ "–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑"
    document.getElementById('checkoutBtn').addEventListener('click', checkoutOrder);

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
    document.getElementById('sortSelect').addEventListener('change', function () {
      const selectedCategory = document.querySelector('.category-btn.bg-blue-100')?.dataset?.category || 'all';
      displayProducts(selectedCategory);
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±–æ—Ä–∞ —Ç–æ–≤–∞—Ä–∞
    document.getElementById('productFilter').addEventListener('change', function () {
      const selectedCategory = document.querySelector('.category-btn.bg-blue-100')?.dataset?.category || 'all';
      displayProducts(selectedCategory);
    });
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    function initApp() {
      loadUserData();
      displayProducts();
      
      console.log('üêæ –ó–æ–æ–º–∞–≥–∞–∑–∏–Ω –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
      console.log('üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', userName, '(ID:', userId, ')');
      console.log('üíé –ë–æ–Ω—É—Å—ã:', bonusPoints);
    }

    // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initApp);
    } else {
      initApp();
    }
   
  </script>
</body>
</html>
